(function e$$0(n,v,c){function g(e,a){if(!v[e]){if(!n[e]){var b="function"==typeof require&&require;if(!a&&b)return b(e,!0);if(l)return l(e,!0);b=Error("Cannot find module '"+e+"'");throw b.code="MODULE_NOT_FOUND",b;}b=v[e]={exports:{}};n[e][0].call(b.exports,function(a){var b=n[e][1][a];return g(b?b:a)},b,b.exports,e$$0,n,v,c)}return v[e].exports}for(var l="function"==typeof require&&require,e=0;e<c.length;e++)g(c[e]);return g})({1:[function(p,n,v){(function(){var c,g,l,e;e=p("./engine/simulation-engine");
l=p("./ui/simulation");c=p("./ui/graph");g=p("./ui/overlay");p("./settings");n.exports=function(){function h(a){this.settings=a;this.engine=new e(settings.simulation.simulationWidth,settings.simulation.simulationHeight,this.settings);this.simulationUI=new l(settings.simulation.simulationCanvas,this.engine,this.settings);this.graphUI=new c(settings.graph.graphCanvas,this.engine,0.02,5,this.settings);this.overlayUI=new g(settings.overlay.overlayCanvas,this.simulationUI,this.settings);this.paused=!1;
this.fps=0;s=[this.simulationUI,this.graphUI,this.overlayUI];z=this.settings.global.updateRate;r=1E3/z;f=1E3/this.settings.global.refreshRate}var a,b,d,q,k,f,t,u,z,r,s;s=[];q=k=u=a=d=b=0;t=-1;f=r=z=0;h.start=function(){var a,b,d;a=0;for(b=s.length;a<b;a++)d=s[a],d.init();return t=setInterval(this.tick,1E3/settings.global.refreshRate)};h.restart=function(){var a,b,d,f;d=[];a=0;for(b=s.length;a<b;a++)f=s[a],d.push(f.restart());return d};h.resume=function(){var a,b,d,f;this.paused=!1;d=[];a=0;for(b=
s.length;a<b;a++)f=s[a],d.push(f.resume());return d};h.pause=function(){var a,b,d,f;this.paused=!0;d=[];a=0;for(b=s.length;a<b;a++)f=s[a],d.push(f.pause());return d};h.stop=function(){if(-1!==t)return clearInterval(t),t=-1};h.getUpdateRate=function(){return z};h.getUpdateTime=function(){return r};h.onTick=function(){};h.update=function(){var b,d,c;a+=f;if(k+r<a){u=a;if(settings.global.enableInterpolation)for(b=d=0,c=this.engine.numOfParticles();0<=c?d<=c:d>=c;b=0<=c?++d:--d)this.engine.getParticle(b).capture();
for(;k+r<a;)this.engine.update(),k+=r}return q=Math.min(1,(a-u)/r)};h.tick=function(){var a,f,c;h.paused||h.update();a=(new Date).getTime();b++;1E3<=a-d&&(h.fps=b,b=0,d=a);a=0;for(f=s.length;a<f;a++)c=s[a],c.draw(q);return h.onTick()};return h}()}).call(this)},{"./engine/simulation-engine":2,"./settings":6,"./ui/graph":7,"./ui/overlay":8,"./ui/simulation":9}],2:[function(p,n,v){(function(){var c;p("../objects/particle");c=p("../math/pvector");n.exports=function(){function g(a,b,d){this.width=a;this.height=
b;this.settings=d}var l,e,h;e=[];g.prototype.setBounds=function(a,b){this.width=a;this.height=b};g.prototype.reset=function(){return e=[]};g.prototype.addParticle=function(a){a.index=e.length;return e.push(a)};g.prototype.removeParticle=function(a){return e.splice(a,1)};g.prototype.getParticle=function(a){return e[a]};g.prototype.numOfParticles=function(){return e.length};l=function(){function a(){}a.prototype.time=0;a.prototype.particle=null;a.prototype.particle2=null;return a}();g.prototype.edgeCollision=
function(a,b){var d;d=a.cOR;a.x+a.radius>=this.width?b?(a.xVel*=-d,a.yVel*=d):a.x=this.width-a.radius:0>=a.x-a.radius&&(b?(a.xVel*=-d,a.yVel*=d):a.x=a.radius);if(a.y+a.radius>=this.height)return b?(a.xVel*=d,a.yVel*=-d):a.y=this.height-a.radius;if(0>=a.y-a.radius)return b?(a.xVel*=d,a.yVel*=-d):a.y=a.radius};g.prototype.collide=function(a,b,d){var q,k,f;k=b.x-a.x;f=b.y-a.y;q=b.radius+a.radius;return k*k+f*f<q*q?(k=new c(a.x-b.x,a.y-b.y),b=new c(a.xVel-b.xVel,a.yVel-b.yVel),a=b.dotProduct(b),b=-2*
b.dotProduct(k),q=k.dotProduct(k)-q*q,q=b*b-4*a*q,f=k=0,0<=q&&(k=(-b-Math.sqrt(q))/(2*a),f=(-b+Math.sqrt(q))/(2*a)),d.time=0<k&&1>=k?k:0<f&&1>=f?f:1,!0):!1};h=function(a,b){var d,q,k,f,e;e=new c(a.xVel,a.yVel);d=Math.PI/2;0!==a.xVel&&(d=Math.atan(a.yVel/a.xVel));f=(a.xVel*Math.cos(-d)-a.yVel*Math.sin(-d))*a.cOR;q=a.x-b.x;k=a.y-b.y;q=0!==q?Math.atan(k/q):Math.atan(k/(q-1E-5));e.x=f*Math.cos(q-d);e.y=f*Math.sin(q-d);return e};g.prototype.handleCollision=function(a){var b,d,c,k,f,e,u,g,r;f=a.particle;
e=a.particle2;r=h(f,e);u=h(e,f);c=(r.x*(f.mass-e.mass)+2*e.mass*u.x)/(f.mass+e.mass);k=(u.x*(e.mass-f.mass)+2*f.mass*r.x)/(f.mass+e.mass);b=Math.atan((f.y-e.y)/(f.x-e.x));d=Math.cos(b);g=Math.sin(b);b=c*d+r.y*g;r=c*g-r.y*d;c=k*d+u.y*g;d=k*g-u.y*d;this.seperateObjects(a,f,e);f.xVel=b;f.yVel=r;e.xVel=c;return e.yVel=d};g.prototype.seperateObjects=function(a,b,d){var e,k;a=a.time+0.001*a.time;if(1>a)return b.x-=b.xVel*settings.global.speedConst*a,b.y-=b.yVel*settings.global.speedConst*a,d.x-=d.xVel*
settings.global.speedConst*a,d.y-=d.yVel*settings.global.speedConst*a;a=d.x-b.x;e=d.y-b.y;a=d.radius-Math.abs(Math.sqrt(a*a+e*e)-b.radius)+0.1;e=(new c(b.xVel,b.yVel)).getMagnitudeNS()+1E-4;k=(new c(d.xVel,d.yVel)).getMagnitudeNS()+1E-4;k=e/(e+k);e=Math.atan2(b.y-d.y,b.x-d.x);b.x+=a*Math.cos(e)*k;b.y+=a*Math.sin(e)*k;k=1-k;d.x-=a*Math.cos(e)*k;return d.y-=a*Math.sin(e)*k};g.prototype.update=function(){var a,b,d,c,k,f,g,u,h;a=0;for(b=e.length;a<b;a++)f=e[a],this.edgeCollision(f,!0),f.update();a=[];
b=d=0;for(k=e.length;d<k;b=++d)for(f=e[b],b=c=u=b,h=e.length;u<=h?c<=h:c>=h;b=u<=h?++c:--c)g=e[b],b=new l,this.collide(f,g,b)&&(b.particle=f,b.particle2=g,a.push(b));a.sort(function(a,b){return a.time<b.time});d=0;for(f=a.length;d<f;d++)b=a[d],this.handleCollision(b);d=[];b=0;for(a=e.length;b<a;b++)f=e[b],d.push(this.edgeCollision(f,!1));return d};return g}()}).call(this)},{"../math/pvector":3,"../objects/particle":4}],3:[function(p,n,v){(function(){n.exports=function(){function c(c,l){this.x=c;this.y=
l}c.prototype.getMagnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};c.prototype.getMagnitudeNS=function(){return this.x*this.x+this.y*this.y};c.prototype.dotProduct=function(c){return this.x*c.x+this.y*c.y};c.prototype.getNormal=function(){return new c(-this.y,this.x)};c.prototype.rotate=function(c){var l,e;l=this.x;e=this.y;this.x=l*Math.cos(c)-e*Math.sin(c);return this.y=l*Math.sin(c)+e*Math.cos(c)};return c}()}).call(this)},{}],4:[function(p,n,v){(function(){var c,g=function(c,
g){function a(){this.constructor=c}for(var b in g)l.call(g,b)&&(c[b]=g[b]);a.prototype=g.prototype;c.prototype=new a;c.__super__=g.prototype;return c},l={}.hasOwnProperty;c=p("./physics-object");n.exports=function(c){function h(a,b,c,f,e){this.x=a;this.y=b;this.radius=c;this.style=f;this.settings=e;h.__super__.constructor.apply(this,arguments)}var a,b;g(h,c);h.prototype.selected=!1;h.prototype.cOR=1;b=[];a=0;h.prototype.draw=function(d,c){var e,f,g,u,h,r;this.displayObj.x=d;this.displayObj.y=c;f=
this.displayObj.graphics;f.clear();if(this.selected){u=b.length;for(e=g=1;1<=u?g<=u:g>=u;e=1<=u?++g:--g)h=b[(e+a)%u],r=h.x-d,h=h.y-c,e/=u,e="rgba(100, 100, 100, "+e+")",f.beginStroke(e).drawCircle(r,h,this.radius).endStroke();f.beginStroke("red").setStrokeStyle(3).drawCircle(0,0,this.radius).endStroke()}f.beginFill(this.style).drawCircle(0,0,this.radius).endFill();if(this.selected||settings.global.showVelocities)return f.beginStroke("red").setStrokeStyle(3).moveTo(0,0).lineTo(this.xVel*settings.global.updateRate,
this.yVel*settings.global.updateRate).endStroke()};h.select=function(){return this.selected=!0};h.deselect=function(){this.selected=!1;return b=[]};h.update=function(){var d;this.x+=this.xVel*this.settings.global.speedConst;this.y+=this.yVel*this.settings.global.speedConst;d=b.length;if(this.selected)return a++,a%=this.settings.global.maxTraceLength,d<this.settings.global.maxTraceLength?b.push(new Point2D(this.x,this.y)):b[a]=new Point2D(this.x,this.y)};h.copy=function(){var a;a=new h(this.x,this.y,
this.radius,this.style,this.settings);a.index=this.index;a.cOR=this.cOR;a.mass=this.mass;a.xVel=this.xVel;a.yVel=this.yVel;return a};return h}(c)}).call(this)},{"./physics-object":5}],5:[function(p,n,v){(function(){n.exports=function(){function c(c,l,e){this.x=c;this.y=l;this.mass=e;this.lastX=this.x;this.lastY=this.y;this.displayObj=new createjs.Shape;this.displayObj.x=this.x;this.displayObj.y=this.y}c.prototype.xVel=0;c.prototype.yVel=0;c.prototype.capture=function(){this.lastX=this.x;return this.lastY=
this.y};c.prototype.update=function(){this.x+=this.xVel;return this.y+=this.yVel};c.prototype.addEventHandle=function(c,l){return this.displayObj.addEventListener(c,l)};c.prototype.getEnergy=function(){return 0.5*this.mass*(this.xVel*this.xVel+this.yVel*this.yVel)};c.prototype.draw=function(c,l){this.displayObj.x=c;return this.displayObj.y=l};return c}()}).call(this)},{}],6:[function(p,n,v){(function(){n.exports=function(){function c(){}c.prototype.global={refreshRate:60,updateRate:60,showVelocities:!1,
enableInterpolation:!0,maxTraceLength:30,speedConst:1,maxParticles:20,minRadius:5,maxRadius:30,errorTime:5E3};c.prototype.simulation={simulationWidth:1E3,simulationHeight:1E3,simulationCanvas:"simulation-canvas"};c.prototype.graph={graphCanvas:"graph-canvas",graphScaleX:0.02,graphScaleY:5,graphZoomFactor:1.25,graphMinZoomIndex:5,graphMaxZoomIndex:5};c.prototype.overlay={overlayCanvas:"overlay-canvas"};return c}()}).call(this)},{}],7:[function(p,n,v){(function(){p("./widget");p("../objects/particle");
n.exports=function(){function c(a,b,d,f,e){this.engine=b;this.scaleX=d;this.scaleY=f;this.settings=e;c.__super__.constructor.call(this,a)}var g,l,e,h,a,b,d,q,k,f,t;h=new createjs.Shape;f=d=b=0;e=[];q=0;a=150;k=!1;t=l=g=0;c.prototype.init=function(){var a,b;a=new createjs.Shape;b=new createjs.Shape;a.graphics.beginStroke("red").moveTo(this.x,this.height).lineTo(this.width,this.height);b.graphics.beginStroke("red").moveTo(this.x,this.y).lineTo(this.x,this.height);this.stage.addChild(a);this.stage.addChild(b);
this.stage.addChild(h);return this.updateData()};c.prototype.draw=function(a){var c,r,s,t,n,p,w,v;if(null!==this.engine){a=h.graphics;a.clear();t=e.length-1;r=s=p=0;for(n=t-1;0<=n?s<=n:s>=n;r=0<=n?++s:--s){if(k){k=!1;return}p+=e[r].y;c=(q+r)%t;r=(q+r+1)%t;w=e[c].x*this.scaleX-b;w>this.width&&(b+=w-this.width);w=e[c].x*this.scaleX-b;v=e[c].y*this.scaleY+d+f;c=e[r].x*this.scaleX-b;r=e[r].y*this.scaleY+d+f;a.beginStroke("red").moveTo(this.x+w,this.y+this.height-v).lineTo(this.x+c,this.y+this.height-
r)}this.paused||(g+=1E3/settings.global.updateRate,l=this.getEnergy(),this.addData(g,l));a=p/e.length;s=this.height/2;d=s-a*this.scaleY;return this.stage.update()}};c.prototype.restart=function(){e=[];b=d=g=l=q=0;return k=!0};c.prototype.calibrate=function(){return f=0};c.prototype.zoomIn=function(){if(t<this.settings.graph.graphMaxZoomIndex)return this.scaleX*=settings.graph.graphZoomFactor,this.scaleY*=settings.graph.graphZoomFactor,b*=this.scaleX,d*=this.scaleY,this.updateData(),t++;throw"ERROR: Maximum zoom reached";
};c.prototype.zoomOut=function(){if(t>-this.settings.graph.graphMinZoomIndex)return this.scaleX/=settings.graph.graphZoomFactor,this.scaleY/=settings.graph.graphZoomFactor,b*=this.scaleX,d*=this.scaleY,this.updateData(),t--;throw"ERROR: Minimum zoom reached";};c.prototype.moveUp=function(){return f-=5};c.prototype.moveDown=function(){return f+=5};c.prototype.updateData=function(){var b,c,d,f,g;c=[];a=Math.round(this.width/(1E3/settings.global.updateRate*this.scaleX))+5;b=e.length-1;d=0;b>a&&(d=b-
a);for(f=d=g=d;g<=b?d<=b:d>=b;f=g<=b?++d:--d)f=(q+f)%b,c.push(e[f]);k=!0;q=0;return e=c};c.prototype.getEnergy=function(){var a,b,c,d;b=c=a=0;for(d=this.engine.numOfParticles();0<=d?c<=d:c>=d;b=0<=d?++c:--c)a+=this.engine.getParticle(b).getEnergy();return Math.round(a/1E3)};return c}()}).call(this)},{"../objects/particle":4,"./widget":10}],8:[function(p,n,v){(function(){p("./widget");n.exports=function(){function c(a,d,f){this.simulation=d;this.settings=f;c.__super__.constructor.call(this,a);this.hide();
stage.addEventListener("stagemousemove",k);$(document).keydown(function(a){b=a.ctrlKey;return g=a.shiftKey});$(document).keyup(function(a){return g=b=!1});this.canvas.bind("contextmenu",function(a){return!1});canvas.mousedown(q);canvas.mousewheel(function(a){if(0>a.deltaY){if(m.radius>settings.global.minRadius)return m.radius-=1}else if(m.radius<settings.global.maxRadius)return m.radius+=1})}var g,l,e,h,a,b,d,q,k,f,t,u,n,r,s,p,v,y,w,A,m,x;f=0;s=-1;v=l=c.width/2;y=e=c.height/2;x=new createjs.Shape;
t=new createjs.Text("","bold 15px Arial");h=new createjs.Text("","bold 15px Arial","red");a=0;A=!1;p=new createjs.Text("","bold 15px Arial");p.x=c.width/2-40;p.y=10;g=b=!1;r=n=0;m=null;d=function(a,b){return b?d(b,a%b):a};u=d(c.width,c.height);w=c;c.prototype.resize=function(a,b){return u=d(this.width,this.height)};c.prototype.init=function(){this.stage.removeAllChildren();v=l=this.width/2;y=e=this.height/2;return this.stage.addChild(p)};k=function(a){var d,c,g,k;v=l=a.stageX;y=e=a.stageY;b||(a=Math.round(v/
u),d=Math.round(y/u),l=a*u,e=d*u);switch(f){case 0:x.x=l;x.y=e;null!==m&&(m.x=l,m.y=e);t.x=l;t.y=e;break;case 1:c=x.graphics;a=l-x.x;d=e-x.y;t.x=x.x+a/2;t.y=x.y+d/2;t.text=Math.round(Math.sqrt(a*a+d*d))+" px/s";m.xVel=a/settings.global.updateRate;m.yVel=d/settings.global.updateRate;c.clear().beginStroke("red").setStrokeStyle(3).moveTo(0,0).lineTo(a,d);break;case 2:for(a=c=0,k=simulation.engine.numOfParticles();0<=k?c<=k:c>=k;a=0<=k?++c:--c)g=simulation.engine.getParticle(a),a=g.x-v,d=g.y-y,a*a+d*
d<=g.radius*g.radius?(g.select(),m=g):g.deselect()}};q=function(a){var b;if(2===a.button&&2!==f){switch(f){case 0:w.end()}reset()}else switch(f){case 0:x.graphics.clear();w.stage.addChild(x);w.stage.addChild(t);f=1;break;case 1:b=simulation.addParticle(m.x,m.y,m.mass,m.radius,m.style);b.xVel=m.xVel;b.yVel=m.yVel;b.cOR=m.cOR;w.stage.removeChild(x);w.stage.removeChild(t);m.xVel=m.yVel=0;1!==s||g?f=0:(f=2,w.stage.removeChild(m.displayObj));break;case 2:m.displayObj.dispatchEvent("click"),2===a.button?
simulation.removeSelected():(b=m,m=b.copy(),n=b.x,r=b.y,w.stage.addChild(m.displayObj),g||simulation.removeSelected(),f=0)}return a.stopPropagation()};c.prototype.draw=function(b){if(!this.hidden)return null!==m&&m.draw(m.x,m.y),A&&(a-=1E3/settings.global.updateRate,0>=a&&(A=!1,this.stage.removeChild(h))),this.stage.update()};c.prototype.reset=function(){var a;if(1===s)return a=simulation.addParticle(n,r,m.mass,m.radius,m.style),a.xVel=m.xVel,a.yVel=m.yVel,w.removeChild(m.displayObj),m=null,f=2;w.stage.removeChild(x);
w.stage.removeChild(t);return f=0};c.prototype.beginAdd=function(a,b,d){this.show();this.init();m=new Particle(l,e,25,d,settings);m.mass=a;m.cOR=b;t.x=v;t.y=y;this.stage.addChild(m.displayObj);p.text="Mode: Add";return s=f=0};c.prototype.beginEdit=function(){this.show();this.init();p.text="Mode: Edit";f=2;return s=1};c.prototype.end=function(){this.hide();this.stage.removeAllChildren();null!==m&&(m=null);s=-1;return g=b=!1};c.prototype.getCurrentParticle=function(){return m};c.prototype.getMode=function(){return s};
return c}()}).call(this)},{"./widget":10}],9:[function(p,n,v){(function(){var c,g,l=function(c,a){function b(){this.constructor=c}for(var d in a)e.call(a,d)&&(c[d]=a[d]);b.prototype=a.prototype;c.prototype=new b;c.__super__=a.prototype;return c},e={}.hasOwnProperty;g=p("./widget");c=p("../objects/particle");n.exports=function(e){function a(b,c,e){this.engine=c;this.settings=e;a.__super__.constructor.call(this,b);this.engine.width=this.width;this.engine.height=this.height}var b;l(a,e);b=-1;a.prototype.resize=
function(a,b){return this.engine.setBounds(a,b)};a.prototype.addParticle=function(a,e,g,f,h){var l,n;a=new c(a,e,f,h,settings);a.mass=g;l=this.engine;n=this;a.addEventHandler("click",function(a){var c,d,f,e,g;f=l.getParticle(b);-1!==b&&(f.deselect(),n.onDeselect(f));g=[];c=d=0;for(e=this.engine.numOfParticles();0<=e?d<=e:d>=e;c=0<=e?++d:--d)if(f=l.getParticle(c),f.displayObj===a.target){c!==b?(n.onSelect(f),b=c,f.selected=!0):b=-1;break}else g.push(void 0);return g});this.stage.addChild(a.displayObj);
this.engine.addParticle(a);return a};a.onSelect=function(a){};a.onDeselect=function(a){};a.removeParticle=function(a){this.stage.removeChild(this.engine.getParticle(a).displayObj);return this.engine.removeParticle(a)};a.loadParticles=function(a){var b,c,f,e,g;this.restart();g=[];b=c=0;for(e=this.engine.numOfParticles();0<=e?c<=e:c>=e;b=0<=e?++c:--c)b=a[b],f=this.addParticle(b.x,b.y,b.mass,b.radius,b.style),f.xVel=b.xVel,f.yVel=b.yVel,g.push(f.cOR=b.cOR);return g};a.saveParticles=function(a){var b,
c,f,e;e=[];b=c=0;for(f=engine.numOfParticles();0<=f?c<=f:c>=f;b=0<=f?++c:--c)b=this.engine.getParticle(b),e.push(a.push(b.copy()));return e};a.removeSelected=function(){if(-1!==b)return this.removeParticle(b),b=-1};a.getSelected=function(){var a;a=null;-1!==b&&(a=this.engine.getParticle(b));return a};a.getSelectedID=function(){return b};a.restart=function(){this.stage.removeAllChildren();b=-1;return this.engine.reset()};a.draw=function(a){var b,c,e,g,h;e=g=0;for(h=this.engine.numOfParticles();0<=
h?g<=h:g>=h;e=0<=h?++g:--g)e=this.engine.getParticle(e),b=e.x,c=e.y,settings.global.enableInterpolation&&(b=e.x-e.lastX,c=e.y-e.lastY,b=e.lastX+a*b,c=e.lastY+a*c),e.draw(b,c);return this.stage.update()};return a}(g)}).call(this)},{"../objects/particle":4,"./widget":10}],10:[function(p,n,v){(function(){n.exports=function(){function c(c){this.canvasName=c;this.canvas=$("#"+canvasName);this.width=this.canvas.width();this.height=this.canvas.height();this.stage=new createjs.Stage(canvasName);this.canvas.attr("width",
this.width);this.canvas.attr("height",this.height)}c.prototype.hidden=!1;c.prototype.init=function(){};c.prototype.addEventListener=function(c,l){return this.stage.addEventListener(c,l)};c.prototype.draw=function(c){};c.prototype.restart=function(){};c.prototype.stop=function(){};c.prototype.resume=function(){return this.paused=!1};c.prototype.pause=function(){return this.paused=!0};c.prototype.resize=function(c,l){this.width=c;return this.height=l};c.prototype.show=function(){this.hidden=!1;return this.canvas.fadeIn(200)};
c.prototype.hide=function(){this.hidden=!0;return this.canvas.fadeOut(200)};return c}()}).call(this)},{}]},{},[1]);
