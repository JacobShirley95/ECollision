(function e$$0(p,s,c){function g(f,b){if(!s[f]){if(!p[f]){var a="function"==typeof require&&require;if(!b&&a)return a(f,!0);if(n)return n(f,!0);a=Error("Cannot find module '"+f+"'");throw a.code="MODULE_NOT_FOUND",a;}a=s[f]={exports:{}};p[f][0].call(a.exports,function(a){var b=p[f][1][a];return g(b?b:a)},a,a.exports,e$$0,p,s,c)}return s[f].exports}for(var n="function"==typeof require&&require,r=0;r<c.length;r++)g(c[r]);return g})({1:[function(m,p,s){(function(){var c,g,n,r,f,b,a=function(a,b){return function(){return a.apply(b,
arguments)}};b=m("./engine/simulation-engine");f=m("./ui/simulation");g=m("./ui/graph");r=m("./ui/overlay");m("./settings");c=m("./events/event-manager");n=m("./interpolator");p.exports=function(){function d(d){this.settings=d;this.tick=a(this.tick,this);this.engine=new b(this.settings.simulation.simulationWidth,this.settings.simulation.simulationHeight,this.settings);this.interpol=new n(this.settings.global.refreshRate,this.settings.global.updateRate,this.engine);this.interpol.lockFPS=!0;this.simulationUI=
new f(this.settings.simulation.simulationCanvas,this.engine,this.interpol,this.settings);this.graphUI=new g(this.settings.graph.graphCanvas,this.engine,0.02,5,this.settings);this.overlayUI=new r(this.settings.overlay.overlayCanvas,this.simulationUI,this.settings);this.paused=!1;this.fps=0;u=[this.simulationUI,this.graphUI,this.overlayUI];t=this.settings.global.updateRate;A=1E3/t;c.eventify(this)}var e,h,k,l,t,A,u;u=[];k=e=h=0;l=-1;t=A=0;d.prototype.start=function(){var a,b,d;a=0;for(b=u.length;a<
b;a++)d=u[a],d.init();return l=setInterval(this.tick,1E3/this.settings.global.refreshRate)};d.prototype.restart=function(){var a,b,d,l;d=[];a=0;for(b=u.length;a<b;a++)l=u[a],d.push(l.restart());return d};d.prototype.resume=function(){var a,b,d,l;this.paused=!1;d=[];a=0;for(b=u.length;a<b;a++)l=u[a],d.push(l.resume());return d};d.prototype.pause=function(){var a,b,d,l;this.paused=!0;d=[];a=0;for(b=u.length;a<b;a++)l=u[a],d.push(l.pause());return d};d.prototype.stop=function(){if(-1!==l)return clearInterval(l),
l=-1};d.prototype.getUpdateRate=function(){return t};d.prototype.getUpdateTime=function(){return A};d.prototype.update=function(){this.interpol.update();return k=this.interpol.interpolation};d.prototype.tick=function(){var a,b,d;this.paused||this.update();a=(new Date).getTime();e++;1E3<=a-h&&(this.fps=e,e=0,h=a);a=0;for(b=u.length;a<b;a++)d=u[a],d.draw(k);return this.fire("tick",[k])};return d}()}).call(this)},{"./engine/simulation-engine":2,"./events/event-manager":3,"./interpolator":4,"./settings":9,
"./ui/graph":10,"./ui/overlay":11,"./ui/simulation":16}],2:[function(m,p,s){(function(){var c,g;m("../objects/particle");g=m("../math/pvector");c=m("../events/event-manager");p.exports=function(){function n(b,a,d){this.width=b;this.height=a;this.settings=d;c.eventify(this)}var r,f;n.prototype.particles=[];n.prototype.setBounds=function(b,a){this.width=b;this.height=a};n.prototype.reset=function(){return this.particles=[]};r=function(){function b(){}b.prototype.time=0;b.prototype.particle=null;b.prototype.particle2=
null;return b}();n.prototype.edgeCollision=function(b,a){var d;d=b.cOR;b.x+b.radius>=this.width?a?(b.xVel*=-d,b.yVel*=d):b.x=this.width-b.radius:0>=b.x-b.radius&&(a?(b.xVel*=-d,b.yVel*=d):b.x=b.radius);if(b.y+b.radius>=this.height)return a?(b.xVel*=d,b.yVel*=-d):b.y=this.height-b.radius;if(0>=b.y-b.radius)return a?(b.xVel*=d,b.yVel*=-d):b.y=b.radius};n.prototype.collide=function(b,a,d){var e,h,k;h=a.x-b.x;k=a.y-b.y;e=a.radius+b.radius;return h*h+k*k<e*e?(h=new g(b.x-a.x,b.y-a.y),a=new g(b.xVel-a.xVel,
b.yVel-a.yVel),b=a.dotProduct(a),a=-2*a.dotProduct(h),e=h.dotProduct(h)-e*e,e=a*a-4*b*e,k=h=0,0<=e&&(h=(-a-Math.sqrt(e))/(2*b),k=(-a+Math.sqrt(e))/(2*b)),d.time=0<h&&1>=h?h:0<k&&1>=k?k:1,!0):!1};f=function(b,a){var d,e,h,k,l;l=new g(b.xVel,b.yVel);d=Math.PI/2;0!==b.xVel&&(d=Math.atan(b.yVel/b.xVel));k=(b.xVel*Math.cos(-d)-b.yVel*Math.sin(-d))*b.cOR;e=b.x-a.x;h=b.y-a.y;e=0!==e?Math.atan(h/e):Math.atan(h/(e-1E-5));l.x=k*Math.cos(e-d);l.y=k*Math.sin(e-d);return l};n.prototype.handleCollision=function(b){var a,
d,e,h,k,l,t,c,g;k=b.particle;l=b.particle2;g=f(k,l);t=f(l,k);e=(g.x*(k.mass-l.mass)+2*l.mass*t.x)/(k.mass+l.mass);h=(t.x*(l.mass-k.mass)+2*k.mass*g.x)/(k.mass+l.mass);a=Math.atan((k.y-l.y)/(k.x-l.x));d=Math.cos(a);c=Math.sin(a);a=e*d+g.y*c;g=e*c-g.y*d;e=h*d+t.y*c;d=h*c-t.y*d;this.seperateObjects(b,k,l);k.xVel=a;k.yVel=g;l.xVel=e;return l.yVel=d};n.prototype.seperateObjects=function(b,a,d){var e,h;b=b.time+0.001*b.time;if(1>b)return a.x-=a.xVel*this.settings.global.speedConst*b,a.y-=a.yVel*this.settings.global.speedConst*
b,d.x-=d.xVel*this.settings.global.speedConst*b,d.y-=d.yVel*this.settings.global.speedConst*b;b=d.x-a.x;e=d.y-a.y;b=d.radius-Math.abs(Math.sqrt(b*b+e*e)-a.radius)+0.1;e=(new g(a.xVel,a.yVel)).getMagnitudeNS()+1E-4;h=(new g(d.xVel,d.yVel)).getMagnitudeNS()+1E-4;h=e/(e+h);e=Math.atan2(a.y-d.y,a.x-d.x);a.x+=b*Math.cos(e)*h;a.y+=b*Math.sin(e)*h;h=1-h;d.x-=b*Math.cos(e)*h;return d.y-=b*Math.sin(e)*h};n.prototype.update=function(){var b,a,d,e,h,k,l,f,c;d=this.particles;b=0;for(a=d.length;b<a;b++)k=d[b],
this.edgeCollision(k,!0),k.update();b=[];f=this.particles;a=d=0;for(h=f.length;d<h;a=++d)for(k=f[a],a=e=a+1,c=this.particles.length-1;e<=c;a=e+=1)l=this.particles[a],a=new r,this.collide(k,l,a)&&(a.particle=k,a.particle2=l,b.push(a));b.sort(function(a,b){return a.time<b.time});d=0;for(k=b.length;d<k;d++)a=b[d],this.handleCollision(a);d=this.particles;a=0;for(b=d.length;a<b;a++)k=d[a],this.edgeCollision(k,!1);return this.fire("update")};return n}()}).call(this)},{"../events/event-manager":3,"../math/pvector":6,
"../objects/particle":7}],3:[function(m,p,s){(function(){p.exports=function(){function c(){}var g,n;g=function(){function c(f,b){this.name=f;this.data=b;this.removed=this.cancelled=!1}c.prototype.cancel=function(){return this.cancelled=!0};c.prototype.remove=function(){return this.removed=!0};return c}();n=[];c.prototype.addListener=function(c,f){(n[c]=n[c]||[]).push(f);return this};c.prototype.removeListener=function(c,f){var b,a,d,e,h,k;if(1===arguments.length)n[c]=[];else if("function"===typeof f&&
(k=n[c],void 0!==k)){b=-1;a=d=0;for(e=k.length;d<e;a=++d)if(h=k[a],h===f){b=a;break}0<=b&&k.splice(b,1)}return this};c.prototype.fire=function(c,f){var b,a,d,e,h,k,l;l=n[c];f=f||[];if(void 0!==l)for(b={},d=e=0,h=l.length;e<h&&(k=l[d],a=new g(c,b),k.apply(window,f.concat(a)),b=a.data,a.removed&&l.splice(d,1),!a.cancelled);d=++e);return this};c.prototype.hasListeners=function(c){var f;return 0<(null!=(f=void 0===n[c])?f:{0:n[c].length})};c.eventify=function(g,f){var b,a,d,e,h,k;h=["addListener","removeListener",
"fire"];f=f||new c;b=function(a){return g[a]=function(){return f[a].apply(f,arguments)}};k=[];a=0;for(d=h.length;a<d;a++)e=h[a],k.push(b(e));return k};return c}()}).call(this)},{}],4:[function(m,p,s){(function(){var c;c=m("./events/event-manager");p.exports=function(){function g(b,a,d){this.renderRate=b;this.updateRate=a;this.engine=d;this.start=(new Date).getTime();c.eventify(this)}var n,r,f;n=r=f=0;g.prototype.interpolation=0;g.prototype.lockFPS=!1;g.prototype.update=function(){var b,a;a=1E3/this.updateRate;
b=1E3/this.renderRate;n=this.lockFPS?(new Date).getTime()-this.start:n+b;if(n-r>=a){this.fire("before-update");for(f=n;n-r>=a;)this.engine.update(),this.fire("update"),r+=a;this.fire("after-update")}return this.interpolation=Math.min(1,(n-f)/a)};return g}()}).call(this)},{"./events/event-manager":3}],5:[function(m,p,s){(function(){p.exports=function(){return function(c,g){this.x=c;this.y=g}}()}).call(this)},{}],6:[function(m,p,s){(function(){p.exports=function(){function c(c,n){this.x=c;this.y=n}
c.prototype.getMagnitude=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};c.prototype.getMagnitudeNS=function(){return this.x*this.x+this.y*this.y};c.prototype.dotProduct=function(c){return this.x*c.x+this.y*c.y};c.prototype.getNormal=function(){return new c(-this.y,this.x)};c.prototype.rotate=function(c){var n,r;n=this.x;r=this.y;this.x=n*Math.cos(c)-r*Math.sin(c);return this.y=n*Math.sin(c)+r*Math.cos(c)};return c}()}).call(this)},{}],7:[function(m,p,s){(function(){var c,g=function(c,f){function b(){this.constructor=
c}for(var a in f)n.call(f,a)&&(c[a]=f[a]);b.prototype=f.prototype;c.prototype=new b;c.__super__=f.prototype;return c},n={}.hasOwnProperty;c=m("./physics-object");m("../math/point-2d");p.exports=function(c){function f(b,a,d,e,c){this.radius=d;this.style=e;this.settings=c;f.__super__.constructor.call(this,b,a,0)}g(f,c);f.prototype.selected=!1;f.prototype.cOR=1;f.prototype.pastPositions=[];f.prototype.curPos=0;f.prototype.update=function(){this.x+=this.xVel*this.settings.global.speedConst;return this.y+=
this.yVel*this.settings.global.speedConst};f.prototype.copy=function(){var b;b=new f(this.x,this.y,this.radius,this.style,this.settings);b.index=this.index;b.cOR=this.cOR;b.mass=this.mass;b.xVel=this.xVel;b.yVel=this.yVel;return b};return f}(c)}).call(this)},{"../math/point-2d":5,"./physics-object":8}],8:[function(m,p,s){(function(){var c;c=m("../events/event-manager");p.exports=function(){function g(g,m,f){this.x=g;this.y=m;this.mass=f;this.lastX=this.x;this.lastY=this.y;c.eventify(this)}g.prototype.xVel=
0;g.prototype.yVel=0;g.prototype.capture=function(){this.lastX=this.x;return this.lastY=this.y};g.prototype.update=function(){this.x+=this.xVel;return this.y+=this.yVel};g.prototype.getEnergy=function(){return 0.5*this.mass*(this.xVel*this.xVel+this.yVel*this.yVel)};return g}()}).call(this)},{"../events/event-manager":3}],9:[function(m,p,s){(function(){p.exports=function(){function c(){}c.prototype.global={refreshRate:24,updateRate:60,showVelocities:!1,enableInterpolation:!0,maxTraceLength:30,speedConst:1,
maxParticles:1E4,minRadius:5,maxRadius:30,errorTime:5E3};c.prototype.simulation={simulationWidth:1E3,simulationHeight:1E3,simulationCanvas:"simulation-canvas",enableSelection:!1};c.prototype.graph={graphCanvas:"graph-canvas",graphScaleX:0.02,graphScaleY:5,graphZoomFactor:1.25,graphMinZoomIndex:5,graphMaxZoomIndex:5};c.prototype.overlay={overlayCanvas:"overlay-canvas"};return c}()}).call(this)},{}],10:[function(m,p,s){(function(){var c,g,n=function(c,b){function a(){this.constructor=c}for(var d in b)r.call(b,
d)&&(c[d]=b[d]);a.prototype=b.prototype;c.prototype=new a;c.__super__=b.prototype;return c},r={}.hasOwnProperty;g=m("./widget");m("../objects/particle");c=m("../math/point-2d");p.exports=function(f){function b(a,d,l,c,e){this.engine=d;this.scaleX=l;this.scaleY=c;this.settings=e;b.__super__.constructor.call(this,a)}var a,d,e,h,k,l,t,g,m,p,r;n(b,f);b.prototype.x=0;b.prototype.y=0;b.prototype.scaleX=0;b.prototype.scaleY=0;h=new createjs.Shape;p=t=l=0;e=[];g=0;k=150;m=!1;r=d=a=0;b.prototype.init=function(){var a,
b;a=new createjs.Shape;b=new createjs.Shape;a.graphics.beginStroke("red").moveTo(this.x,this.height).lineTo(this.width,this.height);b.graphics.beginStroke("red").moveTo(this.x,this.y).lineTo(this.x,this.height);this.stage.addChild(a);this.stage.addChild(b);this.stage.addChild(h);this.stage.update();return this.updateData()};b.prototype.draw=function(b){var c,k,f,n,r,s,q;if(null!==this.engine){b=h.graphics;b.clear();n=e.length-1;for(f=r=0;f<n-1;){if(m){m=!1;return}r+=e[f].y;c=(g+f)%n;k=(g+f+1)%n;s=
e[c].x*this.scaleX-l;s>this.width&&(l+=s-this.width);s=e[c].x*this.scaleX-l;q=e[c].y*this.scaleY+t+p;c=e[k].x*this.scaleX-l;k=e[k].y*this.scaleY+t+p;b.beginStroke("red").moveTo(this.x+s,this.y+this.height-q).lineTo(this.x+c,this.y+this.height-k);f++}this.paused||(a+=1E3/this.settings.global.updateRate,d=this.getEnergy(),this.addData(a,d));b=r/e.length;f=this.height/2;t=f-b*this.scaleY;return this.stage.update()}};b.prototype.restart=function(){e=[];l=t=a=d=g=0;return m=!0};b.prototype.calibrate=function(){return p=
0};b.prototype.zoomIn=function(){if(r<this.settings.graph.graphMaxZoomIndex)return this.scaleX*=this.settings.graph.graphZoomFactor,this.scaleY*=this.settings.graph.graphZoomFactor,l*=this.scaleX,t*=this.scaleY,this.updateData(),r++;throw"ERROR: Maximum zoom reached";};b.prototype.zoomOut=function(){if(r>-this.settings.graph.graphMinZoomIndex)return this.scaleX/=this.settings.graph.graphZoomFactor,this.scaleY/=this.settings.graph.graphZoomFactor,l*=this.scaleX,t*=this.scaleY,this.updateData(),r--;
throw"ERROR: Minimum zoom reached";};b.prototype.moveUp=function(){return p-=5};b.prototype.moveDown=function(){return p+=5};b.prototype.getZoomIndex=function(){return r};b.prototype.addData=function(a,b){var d;return e.length>k?(d=g,g=(g+1)%k,e[d]=new c(a,b)):e.push(new c(a,b))};b.prototype.updateData=function(){var a,b,d,l,c;b=[];k=Math.round(this.width/(1E3/this.settings.global.updateRate*this.scaleX))+5;a=e.length-1;d=0;a>k&&(d=a-k);l=d;for(c=a-1;d<=c;l=d+=1)l=(g+l)%a,b.push(e[l]);m=!0;g=0;return e=
b};b.prototype.getEnergy=function(){var a,b,d,l,c;a=0;c=this.engine.particles;b=0;for(d=c.length;b<d;b++)l=c[b],a+=l.getEnergy();return Math.round(a/1E3)};return b}(g)}).call(this)},{"../math/point-2d":5,"../objects/particle":7,"./widget":17}],11:[function(m,p,s){(function(){var c,g,n=function(b,a){return function(){return b.apply(a,arguments)}},r=function(b,a){function d(){this.constructor=b}for(var c in a)f.call(a,c)&&(b[c]=a[c]);d.prototype=a.prototype;b.prototype=new d;b.__super__=a.prototype;
return b},f={}.hasOwnProperty;g=m("./widget");c=m("../objects/particle");p.exports=function(b){function a(b,l,c){this.simulation=l;this.settings=c;this.handleClick=n(this.handleClick,this);this.handleMouseMove=n(this.handleMouseMove,this);this.handleMouseWheel=n(this.handleMouseWheel,this);a.__super__.constructor.call(this,b);w=e=this.width/2;x=h=this.height/2;z.x=this.width/2-40;s=g(this.width,this.height);this.hide();$(document).keydown(function(a){f=a.ctrlKey;return d=a.shiftKey});$(document).keyup(function(a){return d=
f=!1});this.canvas.bind("contextmenu",function(a){return!1});w=e=this.width/2;x=h=this.height/2;this.stage.addEventListener("stagemousemove",this.handleMouseMove);this.canvas.mousedown(this.handleClick);this.canvas.mousewheel(this.handleMouseWheel)}var d,e,h,k,l,f,g,m,p,s,B,C,y,z,w,x,D,q,v;r(a,b);m=0;y=-1;x=h=w=e=0;v=new createjs.Shape;p=new createjs.Text("","bold 15px Arial");k=new createjs.Text("","bold 15px Arial","red");l=0;D=!1;z=new createjs.Text("","bold 15px Arial");z.x=0;z.y=10;d=f=!1;C=
B=0;q=null;s=0;g=function(a,b){return b?g(b,a%b):a};a.prototype.resize=function(a,b){return s=g(this.width,this.height)};a.prototype.init=function(){this.stage.removeAllChildren();w=e=this.width/2;x=h=this.height/2;return this.stage.addChild(z)};a.prototype.handleMouseWheel=function(a){if(0>a.deltaY){if(q.radius>this.settings.global.minRadius)return q.radius-=1}else if(q.radius<this.settings.global.maxRadius)return q.radius+=1};a.prototype.handleMouseMove=function(a){var b,d,l,c,k;w=e=a.stageX;x=
h=a.stageY;f||(a=Math.round(w/s),b=Math.round(x/s),e=a*s,h=b*s);switch(m){case 0:v.x=e;v.y=h;null!==q&&(q.x=e,q.y=h);p.x=e;p.y=h;break;case 1:d=v.graphics;a=e-v.x;b=h-v.y;p.x=v.x+a/2;p.y=v.y+b/2;p.text=Math.round(Math.sqrt(a*a+b*b))+" px/s";q.xVel=a/this.settings.global.updateRate;q.yVel=b/this.settings.global.updateRate;d.clear().beginStroke("red").setStrokeStyle(3).moveTo(0,0).lineTo(a,b);break;case 2:for(k=this.simulation.engine.particles,d=0,l=k.length;d<l;d++)c=k[d],a=c.x-w,b=c.y-x,a*a+b*b<=
c.radius*c.radius?(c.select(),q=c):c.deselect()}};a.prototype.handleClick=function(a){var b;if(2===a.button&&2!==m){switch(m){case 0:this.end()}this.reset()}else switch(m){case 0:v.graphics.clear();this.stage.addChild(v);this.stage.addChild(p);m=1;break;case 1:b=this.simulation.addParticle(q.x,q.y,q.mass,q.radius,q.style);b.xVel=q.xVel;b.yVel=q.yVel;b.cOR=q.cOR;this.stage.removeChild(v);this.stage.removeChild(p);q.xVel=q.yVel=0;1!==y||d?m=0:(m=2,this.stage.removeChild(q.displayObj));break;case 2:q.displayObj.dispatchEvent("click"),
2===a.button?this.simulation.removeSelected():(b=q,q=b.copy(),B=b.x,C=b.y,this.stage.addChild(q.displayObj),d||this.simulation.removeSelected(),m=0)}return a.stopPropagation()};a.prototype.draw=function(a){if(!this.hidden)return null!==q&&q.draw(q.x,q.y),D&&(l-=1E3/this.settings.global.updateRate,0>=l&&(D=!1,this.stage.removeChild(k))),this.stage.update()};a.prototype.reset=function(){var a;if(1===y)return a=simulation.addParticle(B,C,q.mass,q.radius,q.style),a.xVel=q.xVel,a.yVel=q.yVel,this.removeChild(q.displayObj),
q=null,m=2;this.stage.removeChild(v);this.stage.removeChild(p);return m=0};a.prototype.beginAdd=function(a,b,d){this.show();this.init();q=new c(e,h,25,d,this.settings);q.mass=a;q.cOR=b;p.x=w;p.y=x;this.stage.addChild(q.displayObj);z.text="Mode: Add";return y=m=0};a.prototype.beginEdit=function(){this.show();this.init();z.text="Mode: Edit";m=2;return y=1};a.prototype.end=function(){this.hide();this.stage.removeAllChildren();null!==q&&(q=null);y=-1;return d=f=!1};a.prototype.getCurrentParticle=function(){return q};
a.prototype.getMode=function(){return y};return a}(g)}).call(this)},{"../objects/particle":7,"./widget":17}],12:[function(m,p,s){(function(){var c,g,n=function(c,b){function a(){this.constructor=c}for(var d in b)r.call(b,d)&&(c[d]=b[d]);a.prototype=b.prototype;c.prototype=new a;c.__super__=b.prototype;return c},r={}.hasOwnProperty;c=m("./particle-renderer");g=m("../simulation-renderer");p.exports=function(f){function b(d,c,h){this.canvasName=d;this.interpolator=c;this.settings=h;b.__super__.constructor.call(this,
this.canvasName,this.interpolator);this.stage=new createjs.Stage(this.canvasName);console.log(this.interpolator);this.interpolator.addListener("before-update",function(){var b,d,c,e;e=[];b=0;for(d=a.length;b<d;b++)c=a[b],e.push(c.capture());return e})}var a;n(b,f);a=[];b.prototype.addParticle=function(b){b=new c(b,this.settings.simulation.enableSelection);this.stage.addChild(b.displayObj);return a.push(b)};b.prototype.removeParticle=function(a){};b.prototype.draw=function(b){var c,h,k;c=0;for(h=a.length;c<
h;c++)k=a[c],k.draw(b);return this.stage.update()};return b}(g)}).call(this)},{"../simulation-renderer":15,"./particle-renderer":13}],13:[function(m,p,s){(function(){var c,g,n,r=function(b,a){function d(){this.constructor=b}for(var c in a)f.call(a,c)&&(b[c]=a[c]);d.prototype=a.prototype;b.prototype=new d;b.__super__=a.prototype;return b},f={}.hasOwnProperty;n=m("../renderer");g=m("../../../math/point-2d");c=m("../../../events/event-manager");p.exports=function(b){function a(a,b){this.particle=a;this.displayObj=
new createjs.Shape;d=b;this.lastX=this.particle.x;this.lastY=this.particle.y;this.selected=!1;this.displayObj.x=this.particle.x;this.displayObj.y=this.particle.y;this.displayObj.addEventListener("click",function(a){return function(b){if(a.selected)return a.fire("deselect",[b,a]),a.deselect();a.fire("select",[b,a]);return a.select()}}(this));this.displayObj.graphics.clear().beginFill(this.particle.style).drawCircle(0,0,this.particle.radius).endFill();c.eventify(this)}var d,e,h;r(a,b);h=[];b=0;d=!1;
a.prototype.capture=function(){this.lastX=this.particle.x;return this.lastY=this.particle.y};d&&a.selected&&(b++,b%=20,e=h.length,20>e?h.push(new g(a.x,a.y)):h[b]=new g(a.x,a.y));a.prototype.select=function(){return this.selected=!0};a.prototype.deselect=function(){this.selected=!1;return h=[]};a.prototype.draw=function(a){var b,c,f,g;c=this.particle.x;f=this.particle.y;c=this.lastX+a*(c-this.lastX);f=this.lastY+a*(f-this.lastY);this.displayObj.x=c;this.displayObj.y=f;if(d&&this.selected){e=h.length;
b=a=0;for(f=e-1;a<=f;b=a+=1)g=h[(b+this.particle.curPos)%e],c=g.x-this.particle.x,g=g.y-this.particle.y,b/=e,b="rgba(100, 100, 100, "+b+")",graphics.beginStroke(b).drawCircle(c,g,this.particle.radius).endStroke();return graphics.beginStroke("blue").setStrokeStyle(3).drawCircle(0,0,this.particle.radius).endStroke()}};return a}(n)}).call(this)},{"../../../events/event-manager":3,"../../../math/point-2d":5,"../renderer":14}],14:[function(m,p,s){(function(){p.exports=function(){function c(){}c.prototype.draw=
function(c){};return c}()}).call(this)},{}],15:[function(m,p,s){(function(){var c,g=function(c,f){function b(){this.constructor=c}for(var a in f)n.call(f,a)&&(c[a]=f[a]);b.prototype=f.prototype;c.prototype=new b;c.__super__=f.prototype;return c},n={}.hasOwnProperty;c=m("./renderer");p.exports=function(c){function f(b,a){this.canvas=b;this.interpolator=a}g(f,c);f.prototype.addParticle=function(b){};f.prototype.removeParticle=function(b){};return f}(c)}).call(this)},{"./renderer":14}],16:[function(m,
p,s){(function(){var c,g,n,r,f=function(a,c){function e(){this.constructor=a}for(var h in c)b.call(c,h)&&(a[h]=c[h]);e.prototype=c.prototype;a.prototype=new e;a.__super__=c.prototype;return a},b={}.hasOwnProperty;r=m("./widget");n=m("../objects/particle");g=m("../events/event-manager");c=m("./renderer/easeljs/easeljs-renderer");p.exports=function(a){function b(a,e,l,f){this.engine=e;this.interpolator=l;this.settings=f;b.__super__.constructor.call(this,a);this.engine.width=this.width;this.engine.height=
this.height;this.renderer=new c(this.canvasName,this.interpolator,this.settings);g.eventify(this)}var e;f(b,a);e=null;b.prototype.resize=function(a,b){return this.engine.setBounds(a,b)};b.prototype.addParticle=function(a,b,c,d,e){a=new n(a,b,d,e,this.settings);a.mass=c;this.renderer.addParticle(a);a.addListener("select",function(a){return function(b,c){return a.selected=c}}(this)).addListener("deselect",function(a){return function(b,c){return a.selected=null}}(this));this.engine.particles.push(a);
return a};b.prototype.removeParticle=function(a){this.stage.removeChild(this.engine.particles[a].displayObj);return this.engine.particles.splice(a,1)};b.prototype.loadParticles=function(a){var b,c,d,e,f;this.restart();f=[];b=0;for(c=a.length;b<c;b++)d=a[b],e=this.addParticle(d.x,d.y,d.mass,d.radius,d.style),e.xVel=d.xVel,e.yVel=d.yVel,f.push(e.cOR=d.cOR);return f};b.prototype.saveParticles=function(a){var b,c,d,e,f;e=this.engine.particles;f=[];b=0;for(c=e.length;b<c;b++)d=e[b],f.push(a.push(d.copy()));
return f};b.prototype.removeSelected=function(){var a,b,c,d,f;if(null!==e){f=this.particles;a=b=0;for(c=f.length;b<c;a=++b)d=f[a],d===e&&this.removeParticle(a);return e=null}};b.prototype.getSelected=function(){return e};b.prototype.restart=function(){this.stage.removeAllChildren();e=null;this.engine.reset();return this.fire("restart")};b.prototype.draw=function(a){this.renderer.draw(a);return this.fire("draw")};return b}(r)}).call(this)},{"../events/event-manager":3,"../objects/particle":7,"./renderer/easeljs/easeljs-renderer":12,
"./widget":17}],17:[function(m,p,s){(function(){p.exports=function(){function c(c){this.canvasName=c;this.canvas=$("#"+this.canvasName);this.width=this.canvas.width();this.height=this.canvas.height();this.hidden=!1;this.stage=new createjs.Stage(this.canvasName);this.canvas.attr("width",this.width);this.canvas.attr("height",this.height)}c.prototype.init=function(){};c.prototype.addEventListener=function(c,m){return this.stage.addEventListener(c,m)};c.prototype.draw=function(c){};c.prototype.restart=
function(){};c.prototype.stop=function(){};c.prototype.resume=function(){return this.paused=!1};c.prototype.pause=function(){return this.paused=!0};c.prototype.resize=function(c,m){this.width=c;return this.height=m};c.prototype.show=function(){this.hidden=!1;return this.canvas.fadeIn(200)};c.prototype.hide=function(){this.hidden=!0;return this.canvas.fadeOut(200)};return c}()}).call(this)},{}],18:[function(m,p,s){function c(){for(var a="0123456789ABCDEF".split(""),b="#",c=0;6>c;c++)b+=a[Math.floor(16*
Math.random())];return b}function g(a){a=180*(a/Math.PI)+90;0>a?a+=360:360<a&&(a-=360);return a}function n(a){return(""+a).fontcolor("green")}function r(){if(0==a.overlayUI.getMode())a.overlayUI.end();else{var b=$("#slider-mass").sliderEx("value"),c=$("#slider-cor").sliderEx("value");a.overlayUI.beginAdd(b,c,d)}}function f(){1==a.overlayUI.getMode()?a.overlayUI.end():a.overlayUI.beginEdit()}p=m("../../../bin/out/settings");m=m("../../../bin/out/ecollision");var b=new p,a=new m(b);$.widget("custom.sliderEx",
$.ui.slider,{_unit:"",_amount:null,_formatVal:function(a){0.09<a&&1>a&&(a=a.toPrecision(2));return a+" "+this._unit},_slide:function(){this._superApply(arguments);this._amount.text(this._formatVal(this.options.value));var a=this.handle.position();this._amount.width();this._amount.css("left",a.left+"px")},_start:function(){this._superApply(arguments);var a=this.handle.css("left");this._amount.css("visibility","visible").hide().fadeIn("fast").css("left",a)},_stop:function(){this._superApply(arguments);
this._amount.fadeOut("fast")},_create:function(){var a=parseFloat(this.element.attr("min")),b=parseFloat(this.element.attr("max"));this.options.min=a;this.options.max=b;this.options.step=parseFloat(this.element.attr("step"))||1;this.options.value=parseFloat(this.element.attr("value"))||a+b/2;this._unit=this.element.attr("unit")||"";this._amount=$('<div class="slider-amount">'+this._formatVal(this.options.value)+"</div>");this.element.append(this._amount).mousedown(function(a){a.stopPropagation()});
this._super()}});$("#slider-mass").sliderEx({slide:function(b,c){var d=a.overlayUI.getCurrentParticle()||a.simulationUI.getSelected();null!=d&&(d.mass=c.value)}});$("#slider-cor").sliderEx({slide:function(b,c){var d=a.overlayUI.getCurrentParticle()||a.simulationUI.getSelected();null!=d&&(d.cOR=c.value)}});$(document).keypress(function(a){97==a.charCode?r():101==a.charCode&&f()});$("#add-particle").click(function(){r()});$("#remove-particle").click(function(){f()});var d=c();$("#generate-colour").click(function(){var b=
a.overlayUI.getCurrentParticle()||a.simulationUI.getSelected();null!=b&&(d=c(),b.style=d)});$("#calibrate").click(function(){a.graphUI.calibrate()});$("#zoom-in").click(function(){a.graphUI.zoomIn()});$("#zoom-out").click(function(){a.graphUI.zoomOut()});$("#move-up").click(function(){a.graphUI.moveUp()});$("#move-down").click(function(){a.graphUI.moveDown()});$("#btn-sim-data").click(function(){b.global.showVelocities=!b.global.showVelocities});$("#btn-run-pause").click(function(){a.paused?a.resume():
a.pause();a.paused?$("#btn-run-pause").removeClass("icon-pause").addClass("icon-playback-play").text("RUN"):$("#btn-run-pause").removeClass("icon-playback-play").addClass("icon-pause").text("PAUSE")});$("#btn-next").click(function(){a.update()});var e=[];$("#btn-save").click(function(){e=[];a.simulationUI.saveParticles(e)});$("#btn-load").click(function(){a.simulationUI.loadParticles(e)});$("#btn-reset").click(function(){a.restart()});$("#sim-speed-slider").sliderEx({slide:function(a,c){b.global.speedConst=
parseFloat(c.value)}});var h=$("#fps-div"),k=$("#particle-info-box");a.simulationUI.onSelect=function(a){$("#slider-mass").sliderEx("value",a.mass);$("#slider-cor").sliderEx("value",a.cOR)};a.onTick=function(){if(b.global.showVelocities){var c="",c=24>a.fps?(""+a.fps).fontcolor("red"):(""+a.fps).fontcolor("green");debugStr="Frame rate: "+c+" Hz<br /> Update rate: "+n(a.getUpdateRate())+" Hz<br /> Energy in system: "+n(a.graphUI.getEnergy())+" kJ<br /> Number of particles: "+n(a.engine.numOfParticles());
h.html(debugStr)}else h.html("");c=a.simulationUI.getSelected();if(null!=c){var d="<b>XVel:</b> "+Math.round(c.xVel*b.global.updateRate)+" px/s<br /> <b>YVel:</b> "+Math.round(c.yVel*b.global.updateRate)+" px/s<br /> <b>Direction:</b> "+Math.round(g(Math.atan2(c.yVel,c.xVel)))+" degrees<br /> <b>Mass:</b> "+c.mass+" kg<br /> <b>CoR:</b> "+c.cOR+"<br /> <b>Radius:</b> "+c.radius+" px";"<br /> <b>Energy:</b> "+Math.round(c.getEnergy())+" J";k.html(d)}else k.html("")};a.start()},{"../../../bin/out/ecollision":1,
"../../../bin/out/settings":9}]},{},[18]);
